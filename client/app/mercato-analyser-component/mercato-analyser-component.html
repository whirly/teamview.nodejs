<div class="ui">
    <h1 class="title">Mes petites Stats - Analyseur Mercato</h1>
    <h2 class="subtitle">Un outil qui vous permet de voir rapidement comment chacun a depensé son argent pendant le mercato !</h2>

    <div class="ui one column">
        <div class="eight wide column" *ngIf="!mercatoAvailable">
            <div class="ui form">
                <div class="fields">
                    <div class="five wide field">
                        <input type="text" [(ngModel)]="login" placeholder="Identifiant">
                    </div>
                    <div class="five wide field">
                        <input type="text" [(ngModel)]="password" placeholder="Mot de passe">
                    </div>
                    <div class="eight wide field">
                        <button class="positive ui button" (click)="connectMercato()">Connecter son mercato</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="eight wide column" *ngIf="mercatoAvailable">
        <div class="menu-dark ui {{ getAmountOfLeagues() }} item menu">
            <a class="item {{ isFilterLeague( '' )}}" (click)="filterByLeague( '' )">Pas de mercato sélectionné</a>
            <a *ngFor="let league of availableLeagues" class="item {{ isFilterLeague( league.id )}}" (click)="filterByLeague( league.id )">{{ league.name }}</a>
        </div>
    </div>

    <div class="ui stackable grid spacer">
        <div class="four wide column" *ngFor="let user of mercato?.users">
            <h1 class="team-name">{{ user.teamName }}</h1>
            <h2 class="user-name">{{ user.firstname }} {{ user.lastname }}</h2>

            <table align="center">
                <tbody>
                    <tr>
                        <td>Offres réussis</td>
                        <td>{{ ( user.totalAcceptedOffers / user.totalOffers ) * 100 | number:'.2' }} %</td>
                    </tr>
                    <tr>
                        <td>Budget Goal</td>
                        <td>{{ user.budgetPerLine[ 1 ] }}</td>
                    </tr>
                    <tr>
                        <td>Budget Défense</td>
                        <td>{{ user.budgetPerLine[ 2 ] }}</td>
                    </tr>
                    <tr>
                        <td>Budget Millieux</td>
                        <td>{{ user.budgetPerLine[ 3 ] }}</td>
                    </tr>
                    <tr>
                        <td>Budget Attaque</td>
                        <td>{{ user.budgetPerLine[ 4 ] }}</td>
                    </tr>
                </tbody>
            </table>

            <sui-accordion [closeOthers]="false">
                <sui-accordion-panel [isOpen]="false">
                    <div title>
                        <i class="dropdown icon"></i>
                        Joueurs
                    </div>
                    <div content>
                        <table align="center">
                            <thead>
                            <tr>
                                <th class="head-club"></th>
                                <th class="retrait">Nom</th>
                                <th>Pos</th>
                                <th class="center">Prix</th>
                                <th class="center">Offre</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr *ngFor="let offer of user.players">
                                <td class="body-club emblem {{ getEmblemClass( offer.player.team.name ) }}"></td>
                                <td class="retrait">{{ offer.player.lastName }}</td>
                                <td class="center">
                                    <div ngClass="{{ getCircleClassFor( offer.player.role ) }}">{{ positionShortForm.get( offer.player.role ) }}</div>
                                </td>
                                <td class="center emphase">{{ offer.offers[0].price }}</td>
                                <td class="center emphase">{{ offer.offers.length }}</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </sui-accordion-panel>
            </sui-accordion>
        </div>
    </div>
</div>
